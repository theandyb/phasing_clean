---
title: "trio_phasing_results"
author: "Andy Beck"
date: "2024-05-20"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Introduction

Here in this document we present figures, tables, and statistics for the phasing evaluation on the autosomes. This sample consists of 602 individuals phased using a reference panel of unrelated individuals from the 1000 genomes project. The phasing results are compared to a pedigree-adjusted phased genome for each sample.

## Libraries and Data

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(pander)
library(reactable)
library(yaml)
library(gtsummary)

library(grid)
library(gridExtra) 

config_obj <- yaml::read_yaml("_config.yaml")

cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

df_subj <- read_csv("data/1kgp/subject_info.csv")
ped_df <- read_table("data/1kgp/1kGP.3202_samples.pedigree_info.txt")

child_ids <- ped_df %>% filter(fatherID != "0" & motherID != "0") %>% pull(sampleID)
unrel_ids <- scan("data/1kgp/unrelated_subjects.txt", what = character())

df_subj_rel <- df_subj %>%
  filter(SAMPLE_NAME %in% child_ids)
df_subj_rel$id2 <- 1:602

df_subj_unrel <- df_subj %>%
  filter(SAMPLE_NAME %in% unrel_ids)

```

### Switch Error Summaries

```{r warning=FALSE}
df_switch_trio <- vector(mode = "list", length = 22)


for(i in 1:22){
  df_switch_trio[[i]] <- read_csv(paste0(config_obj$base_dir, "/output/trio_phase_", i, "/switch_errors/summary.csv"),
                                  show_col_types = FALSE)
}

```

And let's also load the results from when we phase without the triple heterozygous positions:

```{r}
df_switch_trio_noth <- read_csv("output/all_noTH.csv", show_col_types = F)
```


### Heterozygous Position Counts

```{r warning=FALSE}
# het dfs
df_het <- vector(mode = "list", length = 22)

for(i in 1:22){
  df_het[[i]] <- read_tsv(paste0(config_obj$base_dir, "/output/trio_phase_", i, "/het_pos_count.tsv"),
                   col_names = c("id", "n_het"), 
                   show_col_types = FALSE)
}


```

### deCODE genetic maps (cM/MB)

```{r warning=FALSE}
df_decode <- vector(mode = "list", length = 22)

for(i in 1:22){
  df_decode[[i]] <- read_tsv(paste0("data/decode/chr", i, "_recomb.bed"), col_names = c("chr", "start", "end", "cM_MB"), show_col_types = FALSE)
}

```

### Chr X Results

We'll also pull in the results on chromosome X for the synthetic diploids to allow for comparisons of rates between 15 and X.

```{r warning=FALSE}
sd_pair_info_df <- read_delim("data/sample_pairs.csv", col_names = c("POP", "ID1", "ID2"))
sd_pair_info_df <- left_join(sd_pair_info_df, df_subj, by = c("ID1"="SAMPLE_NAME")) %>%
  rename(SP = SUPER) %>%
  select(-POPULATION)

df_switch_x <- read_csv(paste0(config_obj$base_dir,"/output/switch_errors/switch_errors/summary.csv"))
df_het_x <- read_tsv(paste0(config_obj$base_dir, "/output/switch_errors/het_pos_count.tsv"), col_names = c("id", "n_het"))
n_var_site_x <- 1722954
df_het_x$frac_het <- df_het_x$n_het / n_var_site_x

sd_pair_info_df$n_het <-df_het_x$n_het
sd_pair_info_df$frac_het <-df_het_x$frac_het

df_decode_x <- read_tsv("data/decode/chrX_recomb.bed", col_names = c("chr", "start", "end", "cM_MB"))
```


## Subject Information

The 1000 Genomes collection of 3,202 genomes is sampled from 26 different populations, each belonging to 1 of 5 distinct super-populations (AFR, AMR, EAS, EUR, SAS). All 26 populations are represented in the 2,504 1kGP phase 3 subjects, but not all are present in the 602 trios sequenced by the New York Genome Center:

```{r warning=FALSE}
df_subj %>%
  group_by(SUPER, POPULATION) %>%
  summarize(N = n()) %>%
  reactable( 
            groupBy = c("SUPER"),
            columns = list(
              N = colDef(aggregate = "sum")),
    bordered = TRUE,
    defaultExpanded = TRUE)

df_subj_rel %>%
  group_by(SUPER, POPULATION) %>%
  summarize(N = n()) %>%
  reactable( 
            groupBy = c("SUPER"),
            columns = list(
              N = colDef(aggregate = "sum")),
    bordered = TRUE,
    defaultExpanded = TRUE)

df_subj_unrel %>%
  group_by(SUPER, POPULATION) %>%
  summarize(N = n()) %>%
  reactable( 
            groupBy = c("SUPER"),
            columns = list(
              N = colDef(aggregate = "sum")),
    bordered = TRUE,
    defaultExpanded = TRUE)
```

For completeness, we also tabulate other summary information about the 602 trios (which is just sex; 1 - male, 2 - female):

```{r warning=FALSE}
df_subj_rel %>%
  group_by(sex) %>%
  summarize(N = n()) %>%
  reactable( 
            groupBy = c("sex"),
            columns = list(
              N = colDef(aggregate = "sum")),
    bordered = TRUE,
    defaultExpanded = TRUE)

df_subj_unrel %>%
  group_by(sex) %>%
  summarize(N = n()) %>%
  reactable( 
            groupBy = c("sex"),
            columns = list(
              N = colDef(aggregate = "sum")),
    bordered = TRUE,
    defaultExpanded = TRUE)
```

## All Autosome Summaries

### Total Errors

First let's get an overall error rate across all 22 autosomes based on our re-phasing of the trio probands:

```{r warning=FALSE}
df_total <- df_switch_trio[[1]] %>%
  mutate(Eagle = (n_other_eagle + n_flip_eagle) / n_hets,
         Beagle = (n_other_beagle + n_flip_beagle) / n_hets,
         SHAPEIT = (n_other_shapeit + n_flip_shapeit) / n_hets) %>%
  select(Eagle, Beagle, SHAPEIT, SUPER, pair_id) %>%
  mutate(chrom = 1)

df_total_noth <- df_switch_trio_noth %>%
  mutate(Eagle = (n_switch_e + n_flip_e) / n_het,
         Beagle = (n_switch_b + n_flip_b) / n_het,
         SHAPEIT = (n_switch_s + n_flip_s) / n_het) %>%
  select(Eagle, Beagle, SHAPEIT, sample, chrom)

df_total_noth <- df_total_noth %>%
  left_join({df_subj_rel %>% select(id2, SUPER)}, by = c("sample" = "id2")) %>%
  rename(pair_id = sample) %>%
  select(Eagle, Beagle, SHAPEIT, SUPER, pair_id, chrom)

for(i in 2:22){
  df_total <- bind_rows(df_total, 
                        {
                          df_switch_trio[[i]] %>%
                            mutate(Eagle = (n_other_eagle + n_flip_eagle) / n_hets,
                                   Beagle = (n_other_beagle + n_flip_beagle) / n_hets,
                                   SHAPEIT = (n_other_shapeit + n_flip_shapeit) / n_hets) %>%
                            select(Eagle, Beagle, SHAPEIT, SUPER, pair_id) %>%
                            mutate(chrom = i)
                        })
}

df_total <- df_total %>%
  bind_rows({df_switch_x %>%
      mutate(Eagle = (n_other_eagle + n_flip_eagle) / n_hets,
                                   Beagle = (n_other_beagle + n_flip_beagle) / n_hets,
                                   SHAPEIT = (n_other_shapeit + n_flip_shapeit) / n_hets) %>%
      rename(SUPER = pop) %>%
                            select(Eagle, Beagle, SHAPEIT, SUPER) %>%
                            mutate(pair_id = 603:1602, chrom = 23)})

df_total_noth <- df_total_noth %>%
  bind_rows({df_switch_x %>%
      mutate(Eagle = (n_other_eagle + n_flip_eagle) / n_hets,
                                   Beagle = (n_other_beagle + n_flip_beagle) / n_hets,
                                   SHAPEIT = (n_other_shapeit + n_flip_shapeit) / n_hets) %>%
      rename(SUPER = pop) %>%
                            select(Eagle, Beagle, SHAPEIT, SUPER) %>%
                            mutate(pair_id = 603:1602, chrom = 23)})
```

#### Total Error Rates: with TH

```{r}
df_total %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  knitr::kable()

df_total %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>% 
  knitr::kable()


df_total %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = method, shape = method)) +
  geom_point(size=3) +
  theme_bw() +
  xlab("Chromosome") +
  ylab("Error Rate") +
  labs(colour = "Method", shape = "Method") +
  scale_colour_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  scale_x_continuous("Chromosome", labels = as.character(unique(df_total$chrom)), breaks = unique(df_total$chrom))

df_total %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = SUPER, shape = method)) +
  geom_point(size=2) +
  theme_bw() +
  ylab("Error Rate") +
  xlab("Chromosome") +
  labs(colour = "Population", shape = "Method") +
  scale_colour_brewer(palette = "Set1")
```

#### Total Error Rates: without TH

```{r}
df_total_noth %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  knitr::kable()

df_total_noth %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>% 
  knitr::kable()

df_total_noth %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = method, shape = method)) +
  geom_point(size=3) +
  theme_bw() +
  xlab("Chromosome") +
  ylab("Error Rate") +
  labs(colour = "Method", shape = "Method") +
  scale_colour_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  scale_x_continuous("Chromosome", labels = as.character(unique(df_total_noth$chrom)), breaks = unique(df_total_noth$chrom))

df_total_noth %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = SUPER, shape = method)) +
  geom_point(size=2) +
  theme_bw() +
  ylab("Error Rate") +
  xlab("Chromosome") +
  labs(colour = "Population", shape = "Method") +
  scale_colour_brewer(palette = "Set1") +
  scale_x_continuous("Chromosome", labels = as.character(unique(df_total_noth$chrom)), breaks = unique(df_total_noth$chrom))

```

In X, do we see large variation among samples?

```{r warning=FALSE}
df_total %>%
  filter(chrom==23) %>%
  select(Beagle, Eagle, SHAPEIT) %>% summary()
```


What range of values do we observe in the autosomes (sans 8)?

```{r warning=FALSE}
df_total_noth %>%
  select(Beagle, Eagle, SHAPEIT) %>%
  summarize(across(.cols = everything(),
                   .fns = list(
                     mean = ~mean(.x, na.rm =T),
                     sd = ~sd(.x, na.rm = T),
                     min = ~min(.x, na.rm=T),
                     max = ~max(.x, na.rm = T)
                   ),
                   .names = "{.col}_{.fn}") 
            ) %>%
  knitr::kable()

df_total_noth %>%
  select(chrom, Beagle, Eagle, SHAPEIT) %>%
  group_by(chrom) %>%
  summarize(across(.cols = everything(),
                   .fns = list(
                     mean = ~mean(.x, na.rm =T),
                     sd = ~sd(.x, na.rm = T),
                     min = ~min(.x, na.rm=T),
                     max = ~max(.x, na.rm = T)
                   ),
                   .names = "{.col}_{.fn}") 
            ) %>%
  knitr::kable()
```


Let's first do a hypothesis test to compare the mean error rates in X versus the autosomes.

```{r warning=FALSE}
# Beagle
autosomes <- df_total_noth %>% filter(chrom < 23) %>% pull(Beagle)
chrX <- df_total_noth %>% filter(chrom == 23) %>% pull(Beagle)
t.test(autosomes, chrX) %>% broom::tidy()

# Eagle
autosomes <- df_total_noth %>% filter(chrom < 23) %>% pull(Eagle)
chrX <- df_total_noth %>% filter(chrom == 23) %>% pull(Eagle)
t.test(autosomes, chrX) %>% broom::tidy()

# SHAPEIT
autosomes <- df_total_noth %>% filter(chrom < 23) %>% pull(SHAPEIT)
chrX <- df_total_noth %>% filter(chrom == 23) %>% pull(SHAPEIT)
t.test(autosomes, chrX) %>% broom::tidy()
```



For each chromosome, we will test several hypotheses:

1. Are the error rates for Beagle, Eagle, and SHAPEIT the same?
2. If the above does not hold, when we do pairwise comparisons between the methods, are error rates the same?
3. Do error rates differ by population? If so, do above tests separately for each population.

For the first test, I'll use a linear mixed model with random intercepts for each individual/synthetic diploid. This will also allow me to do contrasts for the pairwise comparisons.

```{r warning=FALSE}
mod_fit <- df_total_noth %>%
  filter(chrom == 1) %>%
  pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  {lmerTest::lmer(error_rate ~ method + (1|pair_id), data = .)}

df_anova <- anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = 1)

df_pairwise <- emmeans::emmeans(mod_fit, ~ method) %>% pairs() %>% broom::tidy() %>% mutate(chrom=1)

for(i in 2:23){
  mod_fit <- df_total_noth %>%
    filter(chrom == i) %>%
    pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
    {lmerTest::lmer(error_rate ~ method + (1|pair_id), data = .)}
  
  df_anova <- df_anova %>% bind_rows({anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = i)})
  df_pairwise <- df_pairwise %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ method) %>% pairs() %>% broom::tidy() %>% mutate(chrom=i)})
}

df_anova %>% knitr::kable()

df_pairwise %>% knitr::kable()
```

Now let's do these comparisons within each super-population:

```{r warning=FALSE}
mod_fit <- df_total_noth %>%
  filter(chrom == 1) %>%
  pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  {lmerTest::lmer(error_rate ~ method*SUPER + (1|pair_id), data = .)}

df_pop_anova <- anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = 1)

df_pop_pairwise <- emmeans::emmeans(mod_fit, ~ method | SUPER) %>% pairs() %>% broom::tidy() %>% mutate(chrom=1)
df_pop_pop <- emmeans::emmeans(mod_fit, ~ SUPER | method) %>% pairs() %>% broom::tidy() %>% mutate(chrom = 1)

for(i in 2:23){
  mod_fit <- df_total_noth %>%
    filter(chrom == i) %>%
    pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
    {lmerTest::lmer(error_rate ~ method*SUPER + (1|pair_id), data = .)}
  
  df_pop_anova <- df_pop_anova %>% bind_rows({anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = i)})
  df_pop_pairwise <- df_pop_pairwise %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ method | SUPER) %>% pairs() %>% broom::tidy() %>% mutate(chrom=i)})
  df_pop_pop <- df_pop_pop %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ SUPER | method) %>% pairs() %>% broom::tidy() %>% mutate(chrom = i)})
}

df_pop_anova %>% knitr::kable()
df_pop_pairwise %>% knitr::kable()
df_pop_pop %>% knitr::kable()
```

### Switch Errors

Next, let's consider switches and flips independently:

```{r warning=FALSE}
# df_switches <- df_switch_trio[[1]] %>%
#   mutate(Eagle = (n_other_eagle) / n_hets,
#          Beagle = (n_other_beagle) / n_hets,
#          SHAPEIT = (n_other_shapeit) / n_hets) %>%
#   select(Eagle, Beagle, SHAPEIT, SUPER, pair_id) %>%
#   mutate(chrom = 1)
# 
# for(i in 2:22){
#   df_switches <- bind_rows(df_switches, 
#                         {
#                           df_switch_trio[[i]] %>%
#                             mutate(Eagle = (n_other_eagle) / n_hets,
#                                    Beagle = (n_other_beagle) / n_hets,
#                                    SHAPEIT = (n_other_shapeit) / n_hets) %>%
#                             select(Eagle, Beagle, SHAPEIT, SUPER, pair_id) %>%
#                             mutate(chrom = i)
#                         })
# }
# 


df_switches <- df_switch_trio_noth %>%
  mutate(Eagle = (n_switch_e) / n_het,
         Beagle = (n_switch_b) / n_het,
         SHAPEIT = (n_switch_s) / n_het) %>%
  select(Eagle, Beagle, SHAPEIT, sample, chrom)

df_switches <- df_switches %>%
  left_join({df_subj_rel %>% select(id2, SUPER)}, by = c("sample" = "id2")) %>%
  rename(pair_id = sample) %>%
  select(Eagle, Beagle, SHAPEIT, SUPER, pair_id, chrom)

df_switches <- df_switches %>%
  bind_rows({df_switch_x %>%
      mutate(Eagle = (n_other_eagle) / n_hets,
                                   Beagle = (n_other_beagle) / n_hets,
                                   SHAPEIT = (n_other_shapeit) / n_hets) %>%
      rename(SUPER = pop) %>%
                            select(Eagle, Beagle, SHAPEIT, SUPER) %>%
                            mutate(pair_id = 603:1602, chrom = 23)})

df_switches %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  knitr::kable()

df_switches %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%  
  knitr::kable() 

df_switches %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = method, shape = method)) +
  geom_point(size=3) +
  theme_bw() +
  xlab("Chromosome") +
  ylab("Switch Rate") +
  labs(colour = "Method", shape = "Method") +
  scale_colour_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  scale_x_continuous("Chromosome", labels = as.character(unique(df_switches$chrom)), breaks = unique(df_switches$chrom))

df_switches %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = SUPER, shape = method)) +
  geom_point(size=2) +
  theme_bw() +
  ylab("Switch Rate") +
  xlab("Chromosome") +
  labs(colour = "Population", shape = "Method") +
  scale_colour_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  scale_x_continuous("Chromosome", labels = as.character(unique(df_switches$chrom)), breaks = unique(df_switches$chrom))
```


```{r warning=FALSE}
mod_b <- df_switches %>%
  select(Beagle, Eagle, SHAPEIT, chrom, pair_id) %>%
  {lmerTest::lmer(Beagle ~ factor(chrom) + (1|pair_id), data = . )}
anova(mod_b) %>% broom::tidy()
emmeans::emmeans(mod_b, ~ chrom, pbkrtest.limit = 14244) %>% pairs() %>% broom::tidy() %>%
  separate(contrast, into = c("chrom1", "chrom2"), sep = " - ") %>%
  filter(chrom1 %in% "chrom23" | chrom2 %in% "chrom23") %>% 
  knitr::kable()

mod_e <- df_switches %>%
  select(Beagle, Eagle, SHAPEIT, chrom, pair_id) %>%
  {lmerTest::lmer(Eagle ~ factor(chrom) + (1|pair_id), data = . )}
anova(mod_e) %>% broom::tidy()
emmeans::emmeans(mod_e, ~ chrom, pbkrtest.limit = 14244) %>% pairs() %>% broom::tidy() %>%
  separate(contrast, into = c("chrom1", "chrom2"), sep = " - ") %>%
  filter(chrom1 %in% "chrom23" | chrom2 %in% "chrom23") %>% 
  knitr::kable()

mod_s <- df_switches %>%
  select(Beagle, Eagle, SHAPEIT, chrom, pair_id) %>%
  {lmerTest::lmer(SHAPEIT ~ factor(chrom) + (1|pair_id), data = . )}
anova(mod_s) %>% broom::tidy()
emmeans::emmeans(mod_s, ~ chrom, pbkrtest.limit = 14244) %>% pairs() %>% broom::tidy() %>%
  separate(contrast, into = c("chrom1", "chrom2"), sep = " - ") %>%
  filter(chrom1 %in% "chrom23" | chrom2 %in% "chrom23") %>% 
  knitr::kable()

# Beagle
autosomes <- df_switches %>% filter(chrom %in% c(1:7,9:22)) %>% pull(Beagle)
chrX <- df_switches %>% filter(chrom == 23) %>% pull(Beagle)
t.test(autosomes, chrX) %>% broom::tidy()

# Eagle
autosomes <- df_switches %>% filter(chrom < 23) %>% pull(Eagle)
chrX <- df_switches %>% filter(chrom == 23) %>% pull(Eagle)
t.test(autosomes, chrX) %>% broom::tidy()

# SHAPEIT
autosomes <- df_switches %>% filter(chrom < 23) %>% pull(SHAPEIT)
chrX <- df_switches %>% filter(chrom == 23) %>% pull(SHAPEIT)
t.test(autosomes, chrX) %>% broom::tidy()

```

```{r warning=FALSE}
mod_fit <- df_switches %>%
  filter(chrom == 1) %>%
  pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  {lmerTest::lmer(error_rate ~ method + (1|pair_id), data = .)}

df_anova <- anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = 1)

df_pairwise <- emmeans::emmeans(mod_fit, ~ method) %>% pairs() %>% broom::tidy() %>% mutate(chrom=1)

for(i in 2:23){
  mod_fit <- df_switches %>%
    filter(chrom == i) %>%
    pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
    {lmerTest::lmer(error_rate ~ method + (1|pair_id), data = .)}
  
  df_anova <- df_anova %>% bind_rows({anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = i)})
  df_pairwise <- df_pairwise %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ method) %>% pairs() %>% broom::tidy() %>% mutate(chrom=i)})
}

df_anova %>% knitr::kable()

df_pairwise %>% knitr::kable()
```

Now let's do these comparisons within each super-population:

```{r warning=FALSE}
mod_fit <- df_switches %>%
  filter(chrom == 1) %>%
  pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  {lmerTest::lmer(error_rate ~ method*SUPER + (1|pair_id), data = .)}

df_pop_anova <- anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = 1)

df_pop_pairwise <- emmeans::emmeans(mod_fit, ~ method | SUPER) %>% pairs() %>% broom::tidy() %>% mutate(chrom=1)
df_pop_pop <- emmeans::emmeans(mod_fit, ~ SUPER | method) %>% pairs() %>% broom::tidy() %>% mutate(chrom = 1)

for(i in 2:23){
  mod_fit <- df_switches %>%
    filter(chrom == i) %>%
    pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
    {lmerTest::lmer(error_rate ~ method*SUPER + (1|pair_id), data = .)}
  
  df_pop_anova <- df_pop_anova %>% bind_rows({anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = i)})
  df_pop_pairwise <- df_pop_pairwise %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ method | SUPER) %>% pairs() %>% broom::tidy() %>% mutate(chrom=i)})
  df_pop_pop <- df_pop_pop %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ SUPER | method) %>% pairs() %>% broom::tidy() %>% mutate(chrom = i)})
}

df_pop_anova %>% 
  knitr::kable()
df_pop_pairwise %>% knitr::kable()

df_pop_pop %>% knitr::kable()
```

### Flip Errors

```{r warning=FALSE}
# df_flips <- df_switch_trio[[1]] %>%
#   mutate(Eagle = (n_flip_eagle) / n_hets,
#          Beagle = (n_flip_beagle) / n_hets,
#          SHAPEIT = (n_flip_shapeit) / n_hets) %>%
#   select(Eagle, Beagle, SHAPEIT, SUPER, pair_id) %>%
#   mutate(chrom = 1)
# 
# for(i in 2:22){
#   df_flips <- bind_rows(df_flips, 
#                         {
#                           df_switch_trio[[i]] %>%
#                             mutate(Eagle = (n_flip_eagle) / n_hets,
#                                    Beagle = (n_flip_beagle) / n_hets,
#                                    SHAPEIT = (n_flip_shapeit) / n_hets) %>%
#                             select(Eagle, Beagle, SHAPEIT, SUPER, pair_id) %>%
#                             mutate(chrom = i)
#                         })
# }

df_flips <- df_switch_trio_noth %>%
  mutate(Eagle = (n_flip_e) / n_het,
         Beagle = (n_flip_b) / n_het,
         SHAPEIT = (n_flip_s) / n_het) %>%
  select(Eagle, Beagle, SHAPEIT, sample, chrom)

df_flips <- df_flips %>%
  left_join({df_subj_rel %>% select(id2, SUPER)}, by = c("sample" = "id2")) %>%
  rename(pair_id = sample) %>%
  select(Eagle, Beagle, SHAPEIT, SUPER, pair_id, chrom)

df_flips <- df_flips %>%
  bind_rows({df_switch_x %>%
      mutate(Eagle = (n_flip_eagle) / n_hets,
             Beagle = (n_flip_beagle) / n_hets,
             SHAPEIT = (n_flip_shapeit) / n_hets) %>%
      rename(SUPER = pop) %>%
                            select(Eagle, Beagle, SHAPEIT, SUPER) %>%
                            mutate(pair_id = 603:1602, chrom = 23)})

df_flips %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>% 
  knitr::kable()

df_flips %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>% 
  knitr::kable() 

df_flips %>%
  group_by(chrom) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = method, shape = method)) +
  geom_point(size=3) +
  theme_bw() +
  xlab("Chromosome") +
  ylab("Flip Rate") +
  labs(colour = "Method", shape = "Method") +
  scale_colour_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  scale_x_continuous("Chromosome", labels = as.character(unique(df_flips$chrom)), breaks = unique(df_flips$chrom))

df_flips %>%
  group_by(chrom, SUPER) %>%
  summarise(Beagle = mean(Beagle),
            Eagle = mean(Eagle),
            SHAPEIT = mean(SHAPEIT)) %>%
  pivot_longer(Beagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  ggplot(aes(x = chrom, y = error_rate, colour = SUPER, shape = method)) +
  geom_point(size=2) +
  theme_bw() +
  ylab("Flip Rate") +
  xlab("Chromosome") +
  labs(colour = "Population", shape = "Method") +
  scale_colour_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  scale_x_continuous("Chromosome", labels = as.character(unique(df_flips$chrom)), breaks = unique(df_flips$chrom))
```

```{r warning=FALSE}
mod_fit <- df_flips %>%
  filter(chrom == 1) %>%
  pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  {lmerTest::lmer(error_rate ~ method + (1|pair_id), data = .)}

df_anova <- anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = 1)

df_pairwise <- emmeans::emmeans(mod_fit, ~ method) %>% pairs() %>% broom::tidy() %>% mutate(chrom=1)

for(i in 2:23){
  mod_fit <- df_flips %>%
    filter(chrom == i) %>%
    pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
    {lmerTest::lmer(error_rate ~ method + (1|pair_id), data = .)}
  
  df_anova <- df_anova %>% bind_rows({anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = i)})
  df_pairwise <- df_pairwise %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ method) %>% pairs() %>% broom::tidy() %>% mutate(chrom=i)})
}

df_anova %>%
  knitr::kable()

df_pairwise %>%
  knitr::kable()
```

```{r warning=FALSE}
mod_fit <- df_flips %>%
  filter(chrom == 1) %>%
  pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
  {lmerTest::lmer(error_rate ~ method*SUPER + (1|pair_id), data = .)}

df_pop_anova <- anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = 1)

df_pop_pairwise <- emmeans::emmeans(mod_fit, ~ method | SUPER) %>% pairs() %>% broom::tidy() %>% mutate(chrom=1)
df_pop_pop <- emmeans::emmeans(mod_fit, ~ SUPER | method) %>% pairs() %>% broom::tidy() %>% mutate(chrom = 1)

for(i in 2:23){
  mod_fit <- df_flips %>%
    filter(chrom == i) %>%
    pivot_longer(Eagle:SHAPEIT, names_to = "method", values_to = "error_rate") %>%
    {lmerTest::lmer(error_rate ~ method*SUPER + (1|pair_id), data = .)}
  
  df_pop_anova <- df_pop_anova %>% bind_rows({anova(mod_fit) %>% broom::tidy() %>% mutate(chrom = i)})
  df_pop_pairwise <- df_pop_pairwise %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ method | SUPER) %>% pairs() %>% broom::tidy() %>% mutate(chrom=i)})
  df_pop_pop <- df_pop_pop %>% bind_rows({
    emmeans::emmeans(mod_fit, ~ SUPER | method) %>% pairs() %>% broom::tidy() %>% mutate(chrom = i)})
}

df_pop_anova %>%
  knitr::kable()
df_pop_pairwise %>% knitr::kable()

df_pop_pop %>% knitr::kable()
```


## Total Errors

```{r warning=FALSE}
cross_meth_plot <- function(df, p_title, p_func, pop, chrom=as.character(chrom)) {
  p1 <- p_func(df, "Beagle", "SHAPEIT", pop, chrom = chrom)
  p_legend <- cowplot::get_legend(p1)
  
  p1 <- p1 + guides(colour="none") + ggtitle(p_title, paste0("Chromosome ", chrom))
  
  p2 <- p_func(df, "Beagle", "Eagle", pop, chrom = chrom) +
    guides(colour="none") + ggtitle("", "")
  
  p3 <- p_func(df, "SHAPEIT", "Eagle", pop, chrom = chrom) +
    guides(colour="none") + ggtitle("", "")
  
  return(grid.arrange(p1, p_legend, p2, p3, ncol = 2))
  }

plot_total_errors <- function(df, m1, m2, pop, chrom=as.character(chrom)){
  p <- df %>%
    mutate(Beagle = (n_other_beagle + n_flip_beagle),
         Eagle =  (n_other_eagle + n_flip_eagle),
         SHAPEIT =  (n_other_shapeit + n_flip_shapeit)) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Total Errors", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

plot_total_errors_noth <- function(df, m1, m2, pop, chrom=as.character(chrom)){
  p <- df %>%
    mutate(Beagle = (n_switch_b + n_flip_b),
         Eagle =  (n_switch_e + n_flip_e),
         SHAPEIT =  (n_switch_s + n_flip_s)) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Total Errors", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

table_total_errors <- function(df, pop){
  res <- df %>%
    mutate(Beagle = (n_other_beagle + n_flip_beagle),
         Eagle =  (n_other_eagle + n_flip_eagle),
         SHAPEIT =  (n_other_shapeit + n_flip_shapeit)) %>%
    mutate(b_l_e = factor(Beagle < Eagle),
           b_e_e = factor(Beagle == Eagle),
           b_l_s = factor(Beagle < SHAPEIT),
           e_l_b = factor(Beagle > Eagle),
           e_l_s = factor(Eagle < SHAPEIT),
           s_l_b = factor(SHAPEIT < Beagle),
           s_l_e = factor(SHAPEIT < Eagle)) %>%
    tbl_summary(by = !! sym(pop),  
                include = c(b_l_e, b_e_e, b_l_s, e_l_b, e_l_s, s_l_b, s_l_e))
    
  return(res)
}

table_total_errors_noth <- function(df, pop){
  res <- df %>%
    mutate(Beagle = (n_switch_b + n_flip_b),
         Eagle =  (n_switch_e + n_flip_e),
         SHAPEIT =  (n_switch_s + n_flip_s)) %>%
    mutate(b_l_e = factor(Beagle < Eagle),
           b_e_e = factor(Beagle == Eagle),
           b_l_s = factor(Beagle < SHAPEIT),
           e_l_b = factor(Beagle > Eagle),
           e_l_s = factor(Eagle < SHAPEIT),
           s_l_b = factor(SHAPEIT < Beagle),
           s_l_e = factor(SHAPEIT < Eagle)) %>%
    tbl_summary(by = !! sym(pop),  
                include = c(b_l_e, b_e_e, b_l_s, e_l_b, e_l_s, s_l_b, s_l_e))
    
  return(res)
}
```

### Chromosome 1

```{r warning=FALSE}
chrom <- 1

df_switch_trio_noth <- df_switch_trio_noth %>%
  left_join({df_subj_rel %>% select(SUPER, id2)}, by = c("sample" = "id2"))

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 2

```{r warning=FALSE}
chrom <- 2
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 3

```{r warning=FALSE}
chrom <- 3
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 4

```{r warning=FALSE}
chrom <- 4
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 5

```{r warning=FALSE}
chrom <- 5
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 6

```{r warning=FALSE}
chrom <- 6
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 7

```{r warning=FALSE}
chrom <- 7
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 8

```{r warning=FALSE}
chrom <- 8
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 9

```{r warning=FALSE}
chrom <- 9
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 10

```{r warning=FALSE}
chrom <- 10
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 11

```{r warning=FALSE}
chrom <- 10
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 12

```{r warning=FALSE}
chrom <- 12
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 13

```{r warning=FALSE}
chrom <- 13
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 14

```{r warning=FALSE}
chrom <- 14
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 15

```{r warning=FALSE}
chrom <- 15
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 16

```{r warning=FALSE}
chrom <- 16
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 17

```{r warning=FALSE}
chrom <- 17
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 18

```{r warning=FALSE}
chrom <- 18
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 19

```{r warning=FALSE}
chrom <- 19
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 20

```{r warning=FALSE}
chrom <- 20
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 21

```{r warning=FALSE}
chrom <- 21
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome 22

```{r warning=FALSE}
chrom <- 22
plot_total_errors(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "Eagle", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_errors(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_errors, "SUPER", as.character(chrom))
cross_meth_plot({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "Total Errors", plot_total_errors_noth, "SUPER", as.character(chrom))

table_total_errors(df_switch_trio[[chrom]], "SUPER")
table_total_errors_noth({df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ]}, "SUPER")
```

### Chromosome X

```{r warning=FALSE}
plot_total_errors(df_switch_x, "Beagle", "Eagle", "pop", "X")
plot_total_errors(df_switch_x, "Beagle", "SHAPEIT", "pop", "X")
plot_total_errors(df_switch_x, "SHAPEIT", "Eagle", "pop", "X")

table_total_errors(df_switch_x, "pop")

cross_meth_plot(df_switch_x, "Total Errors", plot_total_errors, "pop", "X")
```


## Error Rate

```{r warning=FALSE}
plot_total_rate <- function(df, m1, m2, pop, chrom=as.character(chrom)){
  p <- df %>%
    mutate(Beagle = (n_other_beagle + n_flip_beagle) / n_hets,
         Eagle = (n_other_eagle + n_flip_eagle) / n_hets,
         SHAPEIT = (n_other_shapeit + n_flip_shapeit) / n_hets) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Error Rate", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

plot_total_rate_noth <- function(df, m1, m2, pop, chrom=as.character(chrom)){
  p <- df %>%
    mutate(Beagle = (n_switch_b + n_flip_b) / n_het,
         Eagle = (n_switch_e + n_flip_e) / n_het,
         SHAPEIT = (n_switch_s + n_flip_s) / n_het) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Error Rate", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}
```

### Chromosome 1

```{r warning=FALSE}
chrom <- 1 
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 2

```{r warning=FALSE}
chrom <- 2
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 3

```{r warning=FALSE}
chrom <- 3
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 4

```{r warning=FALSE}
chrom <- 4
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 5

```{r warning=FALSE}
chrom <- 5
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 6

```{r warning=FALSE}
chrom <- 6
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 7

```{r warning=FALSE}
chrom <- 7
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 8

```{r warning=FALSE}
chrom <- 8
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 9

```{r warning=FALSE}
chrom <- 9
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 10

```{r warning=FALSE}
chrom <- 10
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 11

```{r warning=FALSE}
chrom <- 11
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 12

```{r warning=FALSE}
chrom <- 12
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 13

```{r warning=FALSE}
chrom <- 13
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 14

```{r warning=FALSE}
chrom <- 14
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 15

```{r warning=FALSE}
chrom <- 15
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 16

```{r warning=FALSE}
chrom <- 16
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 17

```{r warning=FALSE}
chrom <- 17
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 18

```{r warning=FALSE}
chrom <- 18
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 19

```{r warning=FALSE}
chrom <- 19
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 20

```{r warning=FALSE}
chrom <- 20 
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 21

```{r warning=FALSE}
chrom <- 21 
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 22

```{r warning=FALSE}
chrom <- 22 
plot_total_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)


plot_total_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_total_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_total_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Total Errors", plot_total_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Total Errors", plot_total_rate_noth, "SUPER", as.character(chrom))
```


### Chromosome X

```{r warning=FALSE}
plot_total_rate(df_switch_x, "Beagle", "Eagle", "pop", "X")
plot_total_rate(df_switch_x, "Beagle", "SHAPEIT", "pop", "X")
plot_total_rate(df_switch_x, "SHAPEIT", "Eagle", "pop", "X")

cross_meth_plot(df_switch_x, "Total Errors", plot_total_rate, "pop", "X")
```

## Non-flip Switches

```{r warning=FALSE}
plot_switches <- function(df, m1, m2, pop, chrom=15){
  p <- df %>%
    mutate(Beagle = n_other_beagle,
         Eagle = n_other_eagle,
         SHAPEIT = n_other_shapeit) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Switches", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

plot_switches_noth <- function(df, m1, m2, pop, chrom=15){
  p <- df %>%
    mutate(Beagle = n_switch_b,
         Eagle = n_switch_e,
         SHAPEIT = n_switch_s) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Switches", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

table_switches <- function(df, pop){
  res <- df %>%
    mutate(Beagle = (n_other_beagle ),
         Eagle =  (n_other_eagle),
         SHAPEIT =  (n_other_shapeit)) %>%
    mutate(b_l_e = factor(Beagle < Eagle),
           b_l_s = factor(Beagle < SHAPEIT),
           e_l_b = factor(Beagle > Eagle),
           e_l_s = factor(Eagle < SHAPEIT),
           s_l_b = factor(SHAPEIT < Beagle),
           s_l_e = factor(SHAPEIT < Eagle)) %>%
    tbl_summary(by = !! sym(pop),  
                include = c(b_l_e, b_l_s, e_l_b, e_l_s, s_l_b, s_l_e))
    
  return(res)
}

table_switches_noth <- function(df, pop){
  res <- df %>%
    mutate(Beagle = (n_switch_b ),
         Eagle =  (n_switch_e),
         SHAPEIT =  (n_switch_s)) %>%
    mutate(b_l_e = factor(Beagle < Eagle),
           b_l_s = factor(Beagle < SHAPEIT),
           e_l_b = factor(Beagle > Eagle),
           e_l_s = factor(Eagle < SHAPEIT),
           s_l_b = factor(SHAPEIT < Beagle),
           s_l_e = factor(SHAPEIT < Eagle)) %>%
    tbl_summary(by = !! sym(pop),  
                include = c(b_l_e, b_l_s, e_l_b, e_l_s, s_l_b, s_l_e))
    
  return(res)
}
```

### Chromosome 1

```{r warning=FALSE}
chrom <- 1

plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 2

```{r warning=FALSE}
chrom <- 2
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 3

```{r warning=FALSE}
chrom <- 3
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 4

```{r warning=FALSE}
chrom <- 4
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 5

```{r warning=FALSE}
chrom <- 5
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 6

```{r warning=FALSE}
chrom <- 6
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 7

```{r warning=FALSE}
chrom <- 7
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 8

```{r warning=FALSE}
chrom <- 8
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 9

```{r warning=FALSE}
chrom <- 9
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 10

```{r warning=FALSE}
chrom <- 10
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 11

```{r warning=FALSE}
chrom <- 11
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 12

```{r warning=FALSE}
chrom <- 12
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 13

```{r warning=FALSE}
chrom <- 13
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 14

```{r warning=FALSE}
chrom <- 14
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 15

```{r warning=FALSE}
chrom <- 15
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 16

```{r warning=FALSE}
chrom <- 16
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 17

```{r warning=FALSE}
chrom <- 17
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 18

```{r warning=FALSE}
chrom <- 18
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 19

```{r warning=FALSE}
chrom <- 19
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 20

```{r warning=FALSE}
chrom <- 20
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 21

```{r warning=FALSE}
chrom <- 21
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome 22

```{r warning=FALSE}
chrom <- 22
plot_switches(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switches(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_switches(df_switch_trio[[chrom]], "SUPER")
table_switches_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switches, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switches_noth, "SUPER", as.character(chrom))
```

### Chromosome X

```{r warning=FALSE}
plot_switches(df_switch_x, "Beagle", "Eagle", "pop", "X")
plot_switches(df_switch_x, "Beagle", "SHAPEIT", "pop", "X")
plot_switches(df_switch_x, "SHAPEIT", "Eagle", "pop", "X")

table_switches(df_switch_x, "pop")

cross_meth_plot(df_switch_x, "Switches", plot_switches, "pop", "X")
```

## Switch Rate

```{r warning=FALSE}
plot_switch_rate <- function(df, m1, m2, pop, chrom = 15){
  p <- df %>%
    mutate(Beagle = n_other_beagle / n_hets,
         Eagle = n_other_eagle / n_hets,
         SHAPEIT = n_other_shapeit / n_hets) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Switch Rate", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

plot_switch_rate_noth <- function(df, m1, m2, pop, chrom = 15){
  p <- df %>%
    mutate(Beagle = n_switch_b / n_het,
         Eagle = n_switch_e / n_het,
         SHAPEIT = n_switch_s / n_het) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Switch Rate", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}
```

### Chromosome 1

```{r warning=FALSE}
chrom <- 1
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 2

```{r warning=FALSE}
chrom <- 2
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 3

```{r warning=FALSE}
chrom <- 3
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 4

```{r warning=FALSE}
chrom <- 4
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 5

```{r warning=FALSE}
chrom <- 5
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 6

```{r warning=FALSE}
chrom <- 6
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 7

```{r warning=FALSE}
chrom <- 7
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 8

```{r warning=FALSE}
chrom <- 8
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 9

```{r warning=FALSE}
chrom <- 9
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 10

```{r warning=FALSE}
chrom <- 10
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 11

```{r warning=FALSE}
chrom <- 11
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 12

```{r warning=FALSE}
chrom <- 12
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 13

```{r warning=FALSE}
chrom <- 13
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 14

```{r warning=FALSE}
chrom <- 14
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 15

```{r warning=FALSE}
chrom <- 15
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 16

```{r warning=FALSE}
chrom <- 16
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 17

```{r warning=FALSE}
chrom <- 17
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 18

```{r warning=FALSE}
chrom <- 18
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 19

```{r warning=FALSE}
chrom <- 19
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 20

```{r warning=FALSE}
chrom <- 20
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 21

```{r warning=FALSE}
chrom <- 21
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 22

```{r warning=FALSE}
chrom <- 22
plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_switch_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_switch_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Switches", plot_switch_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Switches", plot_switch_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome X

```{r warning=FALSE}
plot_switch_rate(df_switch_x, "Beagle", "Eagle", "pop", "X")
plot_switch_rate(df_switch_x, "Beagle", "SHAPEIT", "pop", "X")
plot_switch_rate(df_switch_x, "SHAPEIT", "Eagle", "pop", "X")

cross_meth_plot(df_switch_x, "Switches", plot_switch_rate, "pop", "X")
```

## Flips

```{r warning=FALSE}
plot_flips <- function(df, m1, m2, pop, chrom = 15){
  p <- df %>%
    mutate(Beagle = n_flip_beagle,
         Eagle = n_flip_eagle,
         SHAPEIT = n_flip_shapeit) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Total Flips", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

plot_flips_noth <- function(df, m1, m2, pop, chrom = 15){
  p <- df %>%
    mutate(Beagle = n_flip_b,
         Eagle = n_flip_e,
         SHAPEIT = n_flip_s) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Total Flips", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

table_flip <- function(df, pop){
  res <- df %>%
    mutate(Beagle = (n_flip_beagle ),
         Eagle =  (n_flip_eagle),
         SHAPEIT =  (n_flip_shapeit)) %>%
    mutate(b_l_e = factor(Beagle < Eagle),
           b_l_s = factor(Beagle < SHAPEIT),
           e_l_b = factor(Beagle > Eagle),
           e_l_s = factor(Eagle < SHAPEIT),
           s_l_b = factor(SHAPEIT < Beagle),
           s_l_e = factor(SHAPEIT < Eagle)) %>%
    tbl_summary(by = !! sym(pop),  
                include = c(b_l_e, b_l_s, e_l_b, e_l_s, s_l_b, s_l_e))
    
  return(res)
}

table_flip_noth <- function(df, pop){
  res <- df %>%
    mutate(Beagle = (n_flip_b ),
         Eagle =  (n_flip_e),
         SHAPEIT =  (n_flip_s)) %>%
    mutate(b_l_e = factor(Beagle < Eagle),
           b_l_s = factor(Beagle < SHAPEIT),
           e_l_b = factor(Beagle > Eagle),
           e_l_s = factor(Eagle < SHAPEIT),
           s_l_b = factor(SHAPEIT < Beagle),
           s_l_e = factor(SHAPEIT < Eagle)) %>%
    tbl_summary(by = !! sym(pop),  
                include = c(b_l_e, b_l_s, e_l_b, e_l_s, s_l_b, s_l_e))
    
  return(res)
}
```

### Chromosome 1

```{r warning=FALSE}
chrom <- 1
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 2

```{r warning=FALSE}
chrom <- 2
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 3

```{r warning=FALSE}
chrom <- 3
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 4

```{r warning=FALSE}
chrom <- 4
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 5

```{r warning=FALSE}
chrom <- 5
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 6

```{r warning=FALSE}
chrom <- 6
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 7

```{r warning=FALSE}
chrom <- 7
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 8

```{r warning=FALSE}
chrom <- 8
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 9

```{r warning=FALSE}
chrom <- 9
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 10

```{r warning=FALSE}
chrom <- 10
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 11

```{r warning=FALSE}
chrom <- 11
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 12

```{r warning=FALSE}
chrom <- 12
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 13

```{r warning=FALSE}
chrom <- 13
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 14

```{r warning=FALSE}
chrom <- 14
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 15

```{r warning=FALSE}
chrom <- 15
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 16

```{r warning=FALSE}
chrom <- 16
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 17

```{r warning=FALSE}
chrom <- 17
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 18

```{r warning=FALSE}
chrom <- 18
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 19

```{r warning=FALSE}
chrom <- 19
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 20

```{r warning=FALSE}
chrom <- 20
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 21

```{r warning=FALSE}
chrom <- 21
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome 22

```{r warning=FALSE}
chrom <- 22
plot_flips(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "Eagle", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flips(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flips_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SHAPEIT", "Eagle", "SUPER", chrom)

table_flip(df_switch_trio[[chrom]], "SUPER")
table_flip_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "SUPER")

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flips, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom),], "Flips", plot_flips_noth, "SUPER", as.character(chrom))
```

### Chromosome X

```{r warning=FALSE}
plot_flips(df_switch_x, "Beagle", "Eagle", "pop", "X")
plot_flips(df_switch_x, "Beagle", "SHAPEIT", "pop", "X")
plot_flips(df_switch_x, "SHAPEIT", "Eagle", "pop", "X")

table_flip(df_switch_x, "pop")

cross_meth_plot(df_switch_x, "Flips", plot_flips, "pop", "X")
```

## Flip Rate

```{r warning=FALSE}
plot_flip_rate <- function(df, m1, m2, pop, chrom = 15){
  p <- df %>%
    mutate(Beagle = n_flip_beagle / n_hets,
         Eagle = n_flip_eagle / n_hets,
         SHAPEIT = n_flip_shapeit / n_hets) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Flip rate", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}

plot_flip_rate_noth <- function(df, m1, m2, pop, chrom = 15){
  p <- df %>%
    mutate(Beagle = n_flip_b / n_het,
         Eagle = n_flip_e / n_het,
         SHAPEIT = n_flip_s / n_het) %>%
    ggplot(aes(x = !! sym(m1), y = !! sym(m2), colour = !! sym(pop))) +
    geom_point() +
    geom_abline(slope = 1, intercept = 0) +
    ggtitle("Flip rate", paste0("Chromosome ", chrom)) +
    theme_classic() +
    xlab(m1) +
    ylab(m2) +
    labs(color="Population") +
    scale_color_manual(values = cbPalette)
  return(p)
}
```

### Chromosome 1

```{r warning=FALSE}
chrom <- 1

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 2

```{r warning=FALSE}
chrom <- 2

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 3

```{r warning=FALSE}
chrom <- 3

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 4

```{r warning=FALSE}
chrom <- 4

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 5

```{r warning=FALSE}
chrom <- 5

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 6

```{r warning=FALSE}
chrom <- 6

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 7

```{r warning=FALSE}
chrom <- 7

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 8

```{r warning=FALSE}
chrom <- 8

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 9

```{r warning=FALSE}
chrom <- 9

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 10

```{r warning=FALSE}
chrom <- 10

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 11

```{r warning=FALSE}
chrom <- 11

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 12

```{r warning=FALSE}
chrom <- 12

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 13

```{r warning=FALSE}
chrom <- 13

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 14

```{r warning=FALSE}
chrom <- 14

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 15

```{r warning=FALSE}
chrom <- 15

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 16

```{r warning=FALSE}
chrom <- 16

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 17

```{r warning=FALSE}
chrom <- 17

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 18

```{r warning=FALSE}
chrom <- 18

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 19

```{r warning=FALSE}
chrom <- 19

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 20

```{r warning=FALSE}
chrom <- 20

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 21

```{r warning=FALSE}
chrom <- 21

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome 22

```{r warning=FALSE}
chrom <- 22

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "Eagle", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "Beagle", "SHAPEIT", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Beagle", "SHAPEIT", "SUPER", chrom)

plot_flip_rate(df_switch_trio[[chrom]], "SHAPEIT", "Eagle", "SUPER", chrom)
plot_flip_rate_noth(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "SHAPEIT", "Eagle", "SUPER", chrom)

cross_meth_plot(df_switch_trio[[chrom]], "Flips", plot_flip_rate, "SUPER", as.character(chrom))
cross_meth_plot(df_switch_trio_noth[which(df_switch_trio_noth$chrom == chrom), ], "Flips", plot_flip_rate_noth, "SUPER", as.character(chrom))
```

### Chromosome X

```{r warning=FALSE}
plot_flip_rate(df_switch_x, "Beagle", "Eagle", "pop", "X")
plot_flip_rate(df_switch_x, "Beagle", "SHAPEIT", "pop", "X")
plot_flip_rate(df_switch_x, "SHAPEIT", "Eagle", "pop", "X")

cross_meth_plot(df_switch_x, "Flips", plot_flip_rate, "pop", "X")
```



